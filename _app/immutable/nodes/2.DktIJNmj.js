import"../chunks/DsnmJJEf.js";import{i as Na}from"../chunks/DeHQ5rDb.js";import{d as Oa,o as La,s as Z}from"../chunks/C2CeULX7.js";import{e as va,b as Da,s as qe,h as Q,W as Va,a as Ga,t as e,aj as Ya,r as Ua,H as Ba,c as sa,d as ze,k as Ee,X as Ka,$ as ja,f as Ze,i as qa,g as za,ak as na,al as D,am as da,a3 as fa,R as Fa,an as Ie,j as ua,p as Xa,ao as Re,ap as Za,aq as Fe,ar as _a,Z as Ja,as as Wa,a2 as Qa,at as $a,T as et,au as ca,av as at,aw as tt,y as rt,ax as it,ay as lt,z as le,F as x,I as V,B as re,C as E,D as st,az as c,n as H,G as b,J,A as W}from"../chunks/CBDc24iF.js";import{i as ie}from"../chunks/BHoBOJx5.js";function oa(r,i){return i}function nt(r,i,a){for(var n=r.items,u=[],v=i.length,f=0;f<v;f++)Wa(i[f].e,u,!0);var p=v>0&&u.length===0&&a!==null;if(p){var I=a.parentNode;Qa(I),I.append(a),n.clear(),ae(r,i[0].prev,i[v-1].next)}$a(u,()=>{for(var w=0;w<v;w++){var T=i[w];p||(n.delete(T.k),ae(r,T.prev,T.next)),_a(T.e,!p)}})}function Se(r,i,a,n,u,v=null){var f=r,p={flags:i,items:new Map,first:null},I=(i&ca)!==0;if(I){var w=r;f=Q?qe(Va(w)):w.appendChild(va())}Q&&Ga();var T=null,j=!1,G=new Map,R=Ya(()=>{var m=a();return Fa(m)?m:m==null?[]:fa(m)}),s,t;function d(){dt(t,s,p,G,f,u,i,n,a),v!==null&&(s.length===0?T?ua(T):T=Ze(()=>v(f)):T!==null&&Xa(T,()=>{T=null}))}Da(()=>{t??=et,s=e(R);var m=s.length;if(j&&m===0)return;j=m===0;let g=!1;if(Q){var A=Ua(f)===Ba;A!==(m===0)&&(f=sa(),qe(f),ze(!1),g=!0)}if(Q){for(var M=null,S,l=0;l<m;l++){if(Ee.nodeType===Ka&&Ee.data===ja){f=Ee,g=!0,ze(!1);break}var o=s[l],k=n(o,l);S=Je(Ee,p,M,null,o,k,l,u,i,a),p.items.set(k,S),M=S}m>0&&qe(sa())}if(Q)m===0&&v&&(T=Ze(()=>v(f)));else if(qa()){var Y=new Set,q=za;for(l=0;l<m;l+=1){o=s[l],k=n(o,l);var N=p.items.get(k)??G.get(k);N?(i&(Re|Ie))!==0&&ha(N,o,l,i):(S=Je(null,p,null,null,o,k,l,u,i,a,!0),G.set(k,S)),Y.add(k)}for(const[P,se]of p.items)Y.has(P)||q.skipped_effects.add(se.e);q.add_callback(d)}else d();g&&ze(!0),e(R)}),Q&&(f=Ee)}function dt(r,i,a,n,u,v,f,p,I){var w=(f&tt)!==0,T=(f&(Re|Ie))!==0,j=i.length,G=a.items,R=a.first,s=R,t,d=null,m,g=[],A=[],M,S,l,o;if(w)for(o=0;o<j;o+=1)M=i[o],S=p(M,o),l=G.get(S),l!==void 0&&(l.a?.measure(),(m??=new Set).add(l));for(o=0;o<j;o+=1){if(M=i[o],S=p(M,o),l=G.get(S),l===void 0){var k=n.get(S);if(k!==void 0){n.delete(S),G.set(S,k);var Y=d?d.next:s;ae(a,d,k),ae(a,k,Y),Xe(k,Y,u),d=k}else{var q=s?s.e.nodes_start:u;d=Je(q,a,d,d===null?a.first:d.next,M,S,o,v,f,I)}G.set(S,d),g=[],A=[],s=d.next;continue}if(T&&ha(l,M,o,f),(l.e.f&Fe)!==0&&(ua(l.e),w&&(l.a?.unfix(),(m??=new Set).delete(l))),l!==s){if(t!==void 0&&t.has(l)){if(g.length<A.length){var N=A[0],P;d=N.prev;var se=g[0],pe=g[g.length-1];for(P=0;P<g.length;P+=1)Xe(g[P],N,u);for(P=0;P<A.length;P+=1)t.delete(A[P]);ae(a,se.prev,pe.next),ae(a,d,se),ae(a,pe,N),s=N,d=pe,o-=1,g=[],A=[]}else t.delete(l),Xe(l,s,u),ae(a,l.prev,l.next),ae(a,l,d===null?a.first:d.next),ae(a,d,l),d=l;continue}for(g=[],A=[];s!==null&&s.k!==S;)(s.e.f&Fe)===0&&(t??=new Set).add(s),A.push(s),s=s.next;if(s===null)continue;l=s}g.push(l),d=l,s=l.next}if(s!==null||t!==void 0){for(var z=t===void 0?[]:fa(t);s!==null;)(s.e.f&Fe)===0&&z.push(s),s=s.next;var xe=z.length;if(xe>0){var ge=(f&ca)!==0&&j===0?u:null;if(w){for(o=0;o<xe;o+=1)z[o].a?.measure();for(o=0;o<xe;o+=1)z[o].a?.fix()}nt(a,z,ge)}}w&&at(()=>{if(m!==void 0)for(l of m)l.a?.apply()}),r.first=a.first&&a.first.e,r.last=d&&d.e;for(var O of n.values())_a(O.e);n.clear()}function ha(r,i,a,n){(n&Re)!==0&&na(r.v,i),(n&Ie)!==0?na(r.i,a):r.i=a}function Je(r,i,a,n,u,v,f,p,I,w,T){var j=(I&Re)!==0,G=(I&Za)===0,R=j?G?D(u,!1,!1):da(u):u,s=(I&Ie)===0?f:da(f),t={i:s,v:R,k:v,a:null,e:null,prev:a,next:n};try{if(r===null){var d=document.createDocumentFragment();d.append(r=va())}return t.e=Ze(()=>p(r,R,s,w),Q),t.e.prev=a&&a.e,t.e.next=n&&n.e,a===null?T||(i.first=t):(a.next=t,a.e.next=t.e),n!==null&&(n.prev=t,n.e.prev=t.e),t}finally{}}function Xe(r,i,a){for(var n=r.next?r.next.e.nodes_start:a,u=i?i.e.nodes_start:a,v=r.e.nodes_start;v!==null&&v!==n;){var f=Ja(v);u.before(v),v=f}}function ae(r,i,a){i===null?r.first=a:(i.next=a,i.e.next=a&&a.e),a!==null&&(a.prev=i,a.e.prev=i&&i.e)}function ot(r,i,a){var n=r==null?"":""+r;return n===""?null:n}function vt(r,i){return r==null?null:String(r)}function ft(r,i,a,n,u,v){var f=r.__className;if(Q||f!==a||f===void 0){var p=ot(a);(!Q||p!==r.getAttribute("class"))&&(p==null?r.removeAttribute("class"):r.className=p),r.__className=a}return v}function ke(r,i,a,n){var u=r.__style;if(Q||u!==i){var v=vt(i);(!Q||v!==r.getAttribute("style"))&&(v==null?r.removeAttribute("style"):r.style.cssText=v),r.__style=i}return n}function ut(r,i,a,n,u,v,f,p,I,w,T,j,G,R){if(!e(i)||!e(a)){n("まずは移動してから攻撃してください！");return}const s=e(u).filter(t=>Math.abs(t.x-e(v).x)<=f&&Math.abs(t.y-e(v).y)<=f);s.length>0?(n("攻撃！"),c(u,e(u).map(t=>{if(s.some(d=>d.id===t.id)){let d=p.ATK;return(e(I)>=w||e(T)>=w||e(j)===0)&&(d=Math.floor(d*G),n("尿意・便意または兵糧不足で攻撃力が低下している！")),{...t,hp:t.hp-d}}return t}).filter(t=>t.hp>0))):n("攻撃できる敵がいません。"),R()}var _t=(r,i)=>i("player"),ct=()=>{},ht=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-indigo-300" tabindex="0" role="button"> </div>'),mt=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-amber-300"> </div>'),bt=()=>{},pt=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-red-400" tabindex="0" role="button"> </div>'),xt=()=>{},gt=le('<div tabindex="0" role="button"> </div>'),yt=()=>{},wt=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-green-300" tabindex="0" role="button"> </div>'),Tt=()=>{},Et=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-blue-300 opacity-70 border-blue-500" tabindex="0" role="button"> </div>'),At=()=>{},Mt=le('<div class="w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center bg-green-50" tabindex="0" role="button"> </div>'),St=le('<div class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-yellow-200 text-yellow-800 p-4 rounded-lg shadow-2xl z-50 animate-pulse"><p class="text-lg font-semibold"> </p></div>'),kt=le('<div class="min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 font-sans"><div class="bg-white rounded-xl shadow-2xl p-6 md:p-8 w-full max-w-2xl text-center"><h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">排泄管理SRPG</h1> <p class="text-sm md:text-base text-gray-500 mb-6">キャラクターをクリックして移動先を選ぼう！</p> <div class="grid gap-0.5"></div> <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4"><div class="bg-gray-100 p-4 rounded-lg shadow-inner"><h2 class="text-lg font-semibold text-gray-700 mb-2">プレイヤー</h2> <p> </p> <p> </p></div> <div class="bg-gray-100 p-4 rounded-lg shadow-inner"><h2 class="text-lg font-semibold text-gray-700 mb-2">ステータス</h2> <div class="mb-2"><h3 class="text-sm font-medium">尿意</h3> <div class="w-full bg-gray-300 rounded-full h-3"><div class="bg-indigo-500 rounded-full h-3"></div></div></div> <div><h3 class="text-sm font-medium">便意</h3> <div class="w-full bg-gray-300 rounded-full h-3"><div class="bg-orange-500 rounded-full h-3"></div></div></div></div></div> <div class="mt-4 bg-gray-100 p-4 rounded-lg shadow-inner"><h2 class="text-lg font-semibold text-gray-700 mb-2">兵糧</h2> <div class="w-full bg-gray-300 rounded-full h-3"><div class="bg-purple-500 rounded-full h-3"></div></div> <p class="text-sm text-gray-500 mt-2"> </p></div> <div class="mt-4 flex justify-center space-x-4"><button class="px-4 py-2 bg-red-500 text-white font-bold rounded-lg shadow-md hover:bg-red-600 transition-colors duration-200 disabled:bg-gray-400">攻撃</button> <button class="px-4 py-2 bg-blue-500 text-white font-bold rounded-lg shadow-md hover:bg-blue-600 transition-colors duration-200 disabled:bg-gray-400">ターン終了</button></div></div> <!></div>');function Nt(r,i){rt(i,!1);const a=10,n={HP:15,ATK:3,MOVE:3},u={HEAL:1},v={HP:6,ATK:2,MOVE:2},f=1,p=10,I=100,w=.5,T=50,j=1,G=[{x:5,y:5,owner:"neutral"}],R={PLAYER:"👧",DOG:"🐕",ENEMY:"👻",TOILET:"🚽",BUSH:"🌳",GRASS:"🟩",CASTLE:"🏰"};let s=D("player"),t=D({x:0,y:0}),d=D({x:1,y:0}),m=D(n.HP),g=D(0),A=D(0),M=D(T),S=D(""),l=D(!1),o=D([{id:1,x:8,y:8,hp:v.HP,atk:v.ATK},{id:2,x:7,y:3,hp:v.HP,atk:v.ATK}]),k=[{x:3,y:5,type:"TOILET"},{x:8,y:2,type:"BUSH"}],Y=D([...G]),q=D(!1),N=D(!0),P=D([]),se=D(null);La(()=>{e(se)&&clearTimeout(e(se))});function pe(h,_){c(P,[]);for(let y=0;y<a;y++)for(let U=0;U<a;U++)Math.abs(y-h.x)+Math.abs(U-h.y)<=_&&e(P).push({x:y,y:U})}function z(h,_){if(!e(N)||e(q))return;if(e(P).some(U=>U.x===h&&U.y===_)){if(k.find(B=>B.x===h&&B.y===_)){e(g)>0||e(A)>0?(c(g,0),c(A,0),O("スッキリした！")):O("特に用事はないかな..."),ge();return}const oe={...e(t)};c(t,{x:h,y:_}),c(d,oe),c(q,!0);const ve=e(Y).find(B=>B.x===h&&B.y===_);ve&&ve.owner!=="player"?(c(Y,e(Y).map(B=>B.x===h&&B.y===_?{...B,owner:"player"}:B)),O("お城を占領しました！")):O("移動しました"),c(P,[])}else O("そこには移動できません。")}function xe(h){if(!e(N)||e(q))return;let _=n.MOVE;(e(g)>=I||e(A)>=I)&&(_=Math.floor(_*w),O("尿意・便意で移動力が低下している！")),e(M)===0&&(_=Math.floor(_*w),O("兵糧不足で移動力が低下している！")),pe(e(t),_),O("移動先を選択してください。")}function ge(){c(N,!1),O("ターン終了"),c(P,[]),c(s,"enemy")}function O(h){c(S,h),c(l,!0),setTimeout(()=>c(l,!1),2e3)}it(()=>(e(s),e(o),e(t),e(m),e(Y),e(M),e(g),e(A)),()=>{e(s)==="enemy"&&(c(N,!1),O("敵のターン！"),c(o,e(o).map(h=>{const _={...h};if(Math.abs(e(t).x-h.x)+Math.abs(e(t).y-h.y)<=f)c(m,Math.max(0,e(m)-h.atk)),O(`敵の攻撃！HPが ${h.atk} 減った...`);else{let oe=e(t).x-h.x,ve=e(t).y-h.y,B=0,C=_.x,Me=_.y;for(;B<v.MOVE&&(C!==e(t).x||Me!==e(t).y);)C+=oe>0?1:oe<0?-1:0,Me+=ve>0?1:ve<0?-1:0,B++;_.x=C,_.y=Me}return{...h,..._}})),c(se,setTimeout(()=>{c(s,"player"),c(N,!0),c(q,!1),e(Y).some(_=>_.x===e(t).x&&_.y===e(t).y&&_.owner==="player")?(c(m,Math.min(n.HP,e(m)+u.HEAL+2)),c(M,e(M)+5),O("お城でHPと兵糧が少し回復した！")):c(m,Math.min(n.HP,e(m)+u.HEAL)),c(g,Math.min(e(g)+p,I)),c(A,Math.min(e(A)+p,I)),c(M,Math.max(0,e(M)-j)),O("あなたのターン！")},1500)))}),lt(),Na();var Pe=kt(),He=x(Pe),Ae=V(x(He),4);ke(Ae,"grid-template-columns: repeat(10, 1fr);"),Se(Ae,5,()=>H(()=>Array(a)),oa,(h,_,y)=>{var U=J(),oe=W(U);Se(oe,1,()=>H(()=>Array(a)),oa,(ve,B,C,Me)=>{var la=J(),Ea=W(la);{var Aa=ue=>{var ne=ht();ne.__click=[_t,xe],ne.__keydown=[ct];var Ye=x(ne,!0);b(ne),re(()=>Z(Ye,H(()=>R.PLAYER))),E(ue,ne)},Ma=ue=>{var ne=J(),Ye=W(ne);{var Sa=_e=>{var ce=mt(),Ue=x(ce,!0);b(ce),re(()=>Z(Ue,H(()=>R.DOG))),E(_e,ce)},ka=_e=>{var ce=J(),Ue=W(ce);{var Ia=he=>{var F=pt();F.__click=()=>z(C,y),F.__keydown=[bt];var Be=x(F,!0);b(F),re(()=>Z(Be,H(()=>R.ENEMY))),E(he,F)},Ra=he=>{var F=J(),Be=W(F);{var Pa=me=>{var de=J(),Ke=W(de);Se(Ke,1,()=>e(Y),be=>be.x+"-"+be.y,(be,fe)=>{var te=J(),$=W(te);{var ye=ee=>{var K=gt();K.__click=()=>z(C,y),K.__keydown=[xt];var X=x(K,!0);b(K),re(()=>{ft(K,1,`w-8 h-8 md:w-10 md:h-10 border flex items-center justify-center ${e(fe),H(()=>e(fe).owner==="player"?"bg-blue-300":"bg-gray-400")??""}`),Z(X,H(()=>R.CASTLE))}),E(ee,K)};ie($,ee=>{e(fe),H(()=>e(fe).x===C&&e(fe).y===y)&&ee(ye)})}E(be,te)}),E(me,de)},Ha=me=>{var de=J(),Ke=W(de);{var be=te=>{var $=J(),ye=W($);Se(ye,1,()=>k,ee=>ee.x+"-"+ee.y,(ee,K)=>{var X=J(),L=W(X);{var we=je=>{var Te=wt();Te.__click=()=>z(C,y),Te.__keydown=[yt];var Ca=x(Te,!0);b(Te),re(()=>Z(Ca,(e(K),H(()=>e(K).type==="TOILET"?R.TOILET:R.BUSH)))),E(je,Te)};ie(L,je=>{e(K),H(()=>e(K).x===C&&e(K).y===y)&&je(we)})}E(ee,X)}),E(te,$)},fe=te=>{var $=J(),ye=W($);{var ee=X=>{var L=Et();L.__click=()=>z(C,y),L.__keydown=[Tt];var we=x(L,!0);b(L),re(()=>Z(we,H(()=>R.GRASS))),E(X,L)},K=X=>{var L=Mt();L.__click=()=>z(C,y),L.__keydown=[At];var we=x(L,!0);b(L),re(()=>Z(we,H(()=>R.GRASS))),E(X,L)};ie(ye,X=>{e(P),H(()=>e(P).some(L=>L.x===C&&L.y===y))?X(ee):X(K,!1)},!0)}E(te,$)};ie(Ke,te=>{H(()=>k.find($=>$.x===C&&$.y===y))?te(be):te(fe,!1)},!0)}E(me,de)};ie(Be,me=>{e(Y),H(()=>e(Y).find(de=>de.x===C&&de.y===y))?me(Pa):me(Ha,!1)},!0)}E(he,F)};ie(Ue,he=>{e(o),H(()=>e(o).some(F=>F.x===C&&F.y===y))?he(Ia):he(Ra,!1)},!0)}E(_e,ce)};ie(Ye,_e=>{e(d),H(()=>e(d).x===C&&e(d).y===y)?_e(Sa):_e(ka,!1)},!0)}E(ue,ne)};ie(Ea,ue=>{e(t),H(()=>e(t).x===C&&e(t).y===y)?ue(Aa):ue(Ma,!1)})}E(ve,la)}),E(h,U)}),b(Ae);var Ce=V(Ae,2),Ne=x(Ce),Oe=V(x(Ne),2),ma=x(Oe);b(Oe);var We=V(Oe,2),ba=x(We);b(We),b(Ne);var Qe=V(Ne,2),Le=V(x(Qe),2),$e=V(x(Le),2),pa=x($e);b($e),b(Le);var ea=V(Le,2),aa=V(x(ea),2),xa=x(aa);b(aa),b(ea),b(Qe),b(Ce);var De=V(Ce,2),Ve=V(x(De),2),ga=x(Ve);b(Ve);var ta=V(Ve,2),ya=x(ta);b(ta),b(De);var ra=V(De,2),Ge=x(ra);Ge.__click=[ut,N,q,O,o,t,f,n,g,I,A,M,w,ge];var ia=V(Ge,2);ia.__click=ge,b(ra),b(He);var wa=V(He,2);{var Ta=h=>{var _=St(),y=x(_),U=x(y,!0);b(y),b(_),re(()=>Z(U,e(S))),E(h,_)};ie(wa,h=>{e(l)&&h(Ta)})}b(Pe),re(()=>{Z(ma,`HP: ${e(m)??""}`),Z(ba,`ターン: ${e(s)==="player"?"あなたの番":"敵の番"}`),ke(pa,`width:${e(g)}%`),ke(xa,`width:${e(A)}%`),ke(ga,`width:${e(M)}%`),Z(ya,`${e(M)??""}%`),Ge.disabled=!e(N)||!e(q),ia.disabled=!e(N)}),E(r,Pe),st()}Oa(["click","keydown"]);export{Nt as component};
